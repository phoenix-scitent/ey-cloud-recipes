# This file is managed by the nginx_common cookbook.
# Direct changes will be overwitten on the next chef run

# Max size for file uploads
client_max_body_size <%= @client_max_body_size %>;

#error_page 403 406 /system/noaccess/ahahah.html;
location /addyn {
  return 406;
}

<%- if @use_verb_whitelist %>
# Allow only whitelisted HTTP verbs
if ($request_method !~ ^(<%= @whitelisted_verbs %>)$ ) {
  return 403;
}
<%- end %>

# HTTP Error handling.
#
# 404 - Resource Not found.
error_page 404 /404.html;

# 500 - Internal Error
# 502 - Bad Gateway
# 504 - Gateway Timeout
error_page 500 502 504 /500.html;

# 503 - Service Unavailable
error_page 503 @503;
recursive_error_pages on;
location @503 {

  error_page 405 =503 /system/maintenance.html;

  # Serve static assets if found.
  if (-f $request_filename) {
    break;
  }

  rewrite ^(.*)$ /system/maintenance.html break;
}
